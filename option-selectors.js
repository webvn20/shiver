window.Bizweb||(window.Bizweb={}),Bizweb.mediaDomainName="//bizweb.dktcdn.net/",Bizweb.each=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)},Bizweb.getClass=function(e){return Object.prototype.toString.call(e).slice(8,-1)},Bizweb.map=function(e,t){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n},Bizweb.arrayContains=function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},Bizweb.distinct=function(e){for(var t=[],n=0;n<e.length;n++)Bizweb.arrayContains(t,e[n])||t.push(e[n]);return t},Bizweb.getUrlParameter=function(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))},Bizweb.uniq=function(e){for(var t=[],n=0;n<e.length;n++)Bizweb.arrayIncludes(t,e[n])||t.push(e[n]);return t},Bizweb.arrayIncludes=function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},Bizweb.Product=function(){function e(e){if("undefined"!=typeof e)for(property in e)this[property]=e[property]}return e.prototype.optionNames=function(){return"Array"==Bizweb.getClass(this.options)?this.options:[]},e.prototype.optionValues=function(e){if("undefined"==typeof this.variants)return null;var t=Bizweb.map(this.variants,function(t){var n="option"+(e+1);return"undefined"==typeof t[n]?null:t[n]});return null==t[0]?null:Bizweb.distinct(t)},e.prototype.getVariant=function(e){var t=null;return e.length!=this.options.length?null:(Bizweb.each(this.variants,function(n){for(var i=!0,r=0;r<e.length;r++){var o="option"+(r+1);n[o]!=e[r]&&(i=!1)}return i?void(t=n):void 0}),t)},e.prototype.getVariantById=function(e){for(var t=0;t<this.variants.length;t++){var n=this.variants[t];if(n.id==e)return n}return null},e.name="Product",e}(),Bizweb.money_format="{{amount}} VND",Bizweb.formatMoney=function(e,t){function n(e,t,n,i){if("undefined"==typeof t&&(t=2),"undefined"==typeof n&&(n="."),"undefined"==typeof i&&(i=","),"undefined"==typeof e||null==e)return 0;e=e.toFixed(t);var r=e.split("."),o=r[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+n),a=r[1]?i+r[1]:"";return o+a}"string"==typeof e&&(e=e.replace(/\./g,""),e=e.replace(/\,/g,""));var i="",r=/\{\{\s*(\w+)\s*\}\}/,o=t||this.money_format;switch(o.match(r)[1]){case"amount":i=n(e,2);break;case"amount_no_decimals":i=n(e,0);break;case"amount_with_comma_separator":i=n(e,2,".",",");break;case"amount_no_decimals_with_comma_separator":i=n(e,0,".",",")}return o.replace(r,i)},Bizweb.OptionSelectors=function(){function e(e,t){return this.selectorDivClass="selector-wrapper",this.selectorClass="single-option-selector",this.variantIdFieldIdSuffix="-variant-id",this.variantIdField=null,this.selectors=[],this.domIdPrefix=e,this.product=new Bizweb.Product(t.product),"undefined"!=typeof t.onVariantSelected?this.onVariantSelected=t.onVariantSelected:this.onVariantSelected=function(){},this.replaceSelector(e),this.initDropdown(),!0}return e.prototype.replaceSelector=function(e){var t=document.getElementById(e),n=t.parentNode;Bizweb.each(this.buildSelectors(),function(e){n.insertBefore(e,t)}),t.style.display="none",this.variantIdField=t},e.prototype.buildSelectors=function(){for(var e=0;e<this.product.optionNames().length;e++){var t=new Bizweb.SingleOptionSelector(this,e,this.product.optionNames()[e],this.product.optionValues(e));t.element.disabled=!1,this.selectors.push(t)}var n=this.selectorDivClass,i=this.product.optionNames(),r=Bizweb.map(this.selectors,function(e){var t=document.createElement("div");if(t.setAttribute("class",n),i.length>1){var r=document.createElement("label");r.htmlFor=e.element.id,r.innerHTML=e.name,t.appendChild(r)}return t.appendChild(e.element),t});return r},e.prototype.initDropdown=function(){var e={initialLoad:!0},t=this.selectVariantFromDropdown(e);if(!t){var n=this;setTimeout(function(){n.selectVariantFromParams(e)||n.selectors[0].element.onchange(e)})}},e.prototype.selectVariantFromDropdown=function(e){var t=document.getElementById(this.domIdPrefix).querySelector("[selected]");return t?this.selectVariant(t.value,e):!1},e.prototype.selectVariantFromParams=function(e){var t=Bizweb.getUrlParameter("variantid");return null==t&&(t=Bizweb.getUrlParameter("variantId")),this.selectVariant(t,e)},e.prototype.selectVariant=function(e,t){var n=this.product.getVariantById(e);if(null==n)return!1;for(var i=0;i<this.selectors.length;i++){var r=this.selectors[i].element,o=r.getAttribute("data-option"),a=n[o];null!=a&&this.optionExistInSelect(r,a)&&(r.value=a)}return"undefined"!=typeof jQuery?jQuery(this.selectors[0].element).trigger("change",t):this.selectors[0].element.onchange(t),!0},e.prototype.optionExistInSelect=function(e,t){for(var n=0;n<e.options.length;n++)if(e.options[n].value==t)return!0},e.prototype.updateSelectors=function(e,t){var n=this.selectedValues(),i=this.product.getVariant(n);i?(this.variantIdField.disabled=!1,this.variantIdField.value=i.id):this.variantIdField.disabled=!0,this.onVariantSelected(i,this,t),null!=this.historyState&&this.historyState.onVariantChange(i,this,t)},e.prototype.selectedValues=function(){for(var e=[],t=0;t<this.selectors.length;t++){var n=this.selectors[t].element.value;e.push(n)}return e},e.name="OptionSelectors",e}(),Bizweb.SingleOptionSelector=function(e,t,n,i){this.multiSelector=e,this.values=i,this.index=t,this.name=n,this.element=document.createElement("select");for(var r=0;r<i.length;r++){var o=document.createElement("option");o.value=i[r],o.innerHTML=i[r],this.element.appendChild(o)}return this.element.setAttribute("class",this.multiSelector.selectorClass),this.element.setAttribute("data-option","option"+(t+1)),this.element.id=e.domIdPrefix+"-option-"+t,this.element.onchange=function(n,i){i=i||{},e.updateSelectors(t,i)},!0},Bizweb.Image={preload:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];this.loadImage(this.getSizedImageUrl(i,t))}},loadImage:function(e){(new Image).src=e},switchImage:function(e,t,n){if(e&&t){var i=this.imageSize(t.src),r=this.getSizedImageUrl(e.src,i);n?n(r,e,t):t.src=r}},imageSize:function(e){var t=e.match(/thumb\/(1024x1024|2048x2048|pico|icon|thumb|small|compact|medium|large|grande)\//);return null!=t?t[1]:null},getSizedImageUrl:function(e,t){if(null==t)return e;if("master"==t)return this.removeProtocol(e);var n=e.match(/\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\?v=\d+)?$/i);if(null!=n){var i=Bizweb.mediaDomainName+"thumb/"+t+"/";return this.removeProtocol(e).replace(Bizweb.mediaDomainName,i).split("?")[0]}return null},removeProtocol:function(e){return e.replace(/http(s)?:/,"")}};